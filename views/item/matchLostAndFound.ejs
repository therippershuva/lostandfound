<div class="border shadow-sm rounded-2 my-5">
    <div class="d-flex flex-row min-vh-80">
        <div class="p-5 flex-fill">
            <h2 class="h2 text-center">Lost Item</h2>
            <dialog
                id="favDialog"
                class="m-auto p-5"
                style="
                    min-height: 70vh;
                    min-width: 60vw;
                    border-radius: 2em;
                    border: 0;
                    box-shadow: 0 0 0.5em 0.5em rgba(0, 0, 0, 0.25);
                    box-shadow:
                        0 3px 6px rgba(0, 0, 0, 0.16),
                        0 3px 6px rgba(0, 0, 0, 0.23);
                "
            >
                <div class="row justify-content-start">
                    <% lostItems.forEach(element => { %>
                    <div class="col-3 col-md-4 my-2">
                        <div class="card hover-scale">
                            <% if (element && element.images &&
                            element.images.length > 0) {%>
                            <img
                                class="card-img-top"
                                src="/<%= element.images[0] %>"
                                alt="Title"
                                style="object-fit: cover; max-height: 200px"
                            />
                            <% }%>
                            <div class="card-body">
                                <h4 class="card-title"><%= element.name %></h4>

                                <table>
                                    <tr>
                                        <td>
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                height="1em"
                                                viewBox="0 0 384 512"
                                                class="mb-1 me-2"
                                            >
                                                <path
                                                    d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"
                                                />
                                            </svg>
                                        </td>
                                        <td><%= element.lostLocation %></td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                height="1em"
                                                viewBox="0 0 448 512"
                                                class="mb-1 me-2"
                                            >
                                                <path
                                                    d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"
                                                />
                                            </svg>
                                        </td>
                                        <td>
                                            <%=
                                            element.lostDate.toLocaleString("en-US",
                                            { day: "numeric", month: "short",
                                            year:"numeric"}); %>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <% }) %>
                </div>
                <button
                    id="closeDialog"
                    class="btn btn-outline-danger"
                    onclick="favDialog.close()"
                >
                    Cancel
                </button>
            </dialog>
            <p>
                <button id="showDialog" class="btn btn-primary w-100">
                    Choose Lost Item
                </button>
            </p>
            <output></output>
        </div>
        <div class="vr" style="max-width: 2px"></div>
        <div class="p-5 flex-fill">
            <h2 class="h2 text-center">Found Item</h2>
            <dialog
                id="favDialog"
                class="m-auto p-5"
                style="
                    min-height: 70vh;
                    min-width: 60vw;
                    border-radius: 2em;
                    border: 0;
                    box-shadow: 0 0 0.5em 0.5em rgba(0, 0, 0, 0.25);
                    box-shadow:
                        0 3px 6px rgba(0, 0, 0, 0.16),
                        0 3px 6px rgba(0, 0, 0, 0.23);
                "
            >
                <div class="row justify-content-start gap-3">
                    <% foundItems.forEach(element => { %>
                    <div class="col-3 col-md-4 my-2">
                        <div class="card hover-scale">
                            <% if (element && element.images &&
                            element.images.length > 0) {%>
                            <img
                                class="card-img-top"
                                src="/<%= element.images[0] %>"
                                alt="Title"
                                style="object-fit: cover; max-height: 200px"
                            />
                            <% }%>
                            <div class="card-body">
                                <h4 class="card-title"><%= element.name %></h4>

                                <table>
                                    <tr>
                                        <td>
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                height="1em"
                                                viewBox="0 0 384 512"
                                                class="mb-1 me-2"
                                            >
                                                <path
                                                    d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"
                                                />
                                            </svg>
                                        </td>
                                        <td><%= element.foundLocation %></td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                height="1em"
                                                viewBox="0 0 448 512"
                                                class="mb-1 me-2"
                                            >
                                                <path
                                                    d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z"
                                                />
                                            </svg>
                                        </td>
                                        <td>
                                            <%=
                                            element.foundDate.toLocaleString("en-US",
                                            { day: "numeric", month: "short",
                                            year: "numeric", }); %>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <% }) %>
                </div>
            </dialog>
            <p>
                <button id="showDialog" class="btn btn-primary w-100">
                    Choose Found Item
                </button>
            </p>
            <output></output>
        </div>
    </div>
</div>

<script>
    const showButton = document.getElementById("showDialog");
    const favDialog = document.getElementById("favDialog");
    const outputBox = document.querySelector("output");
    const selectEl = favDialog.querySelector("select");
    const confirmBtn = favDialog.querySelector("#confirmBtn");

    // "Show the dialog" button opens the <dialog> modally
    showButton.addEventListener("click", () => {
        favDialog.showModal();
    });

    // "Favorite animal" input sets the value of the submit button
    selectEl.addEventListener("change", (e) => {
        confirmBtn.value = selectEl.value;
    });

    // "Cancel" button closes the dialog without submitting because of [formmethod="dialog"], triggering a close event.
    favDialog.addEventListener("close", (e) => {
        outputBox.value =
            favDialog.returnValue === "default"
                ? "No return value."
                : `ReturnValue: ${favDialog.returnValue}.`; // Have to check for "default" rather than empty string
    });

    // Prevent the "confirm" button from the default behavior of submitting the form, and close the dialog with the `close()` method, which triggers the "close" event.
    confirmBtn.addEventListener("click", (event) => {
        event.preventDefault(); // We don't want to submit this fake form
        favDialog.close(selectEl.value); // Have to send the select box value here.
    });

    cancelBth.addEventListener("click", (event) => {
        event.preventDefault();
        console.log("click"); // We don't want to submit this fake form
        favDialog.close(1); // Have to send the select box value here.
    });
</script>
